
loading word table...
loading word table finished!!! 0.42 seconds escaped...
2018-10-30 20:16:33.083021: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-10-30 20:16:33.622680: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:08:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-10-30 20:16:33.953692: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:0b:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-10-30 20:16:34.294177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:0e:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-10-30 20:16:34.663576: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 3 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:11:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-10-30 20:16:34.672658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3
2018-10-30 20:16:35.913930: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-10-30 20:16:35.914002: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 
2018-10-30 20:16:35.914015: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y 
2018-10-30 20:16:35.914021: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y 
2018-10-30 20:16:35.914026: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y 
2018-10-30 20:16:35.914031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N 
2018-10-30 20:16:35.916013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21551 MB memory) -> physical GPU (device: 0, name: Tesla P40, pci bus id: 0000:08:00.0, compute capability: 6.1)
2018-10-30 20:16:35.918116: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 21551 MB memory) -> physical GPU (device: 1, name: Tesla P40, pci bus id: 0000:0b:00.0, compute capability: 6.1)
2018-10-30 20:16:35.920179: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 21551 MB memory) -> physical GPU (device: 2, name: Tesla P40, pci bus id: 0000:0e:00.0, compute capability: 6.1)
2018-10-30 20:16:35.921909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 21551 MB memory) -> physical GPU (device: 3, name: Tesla P40, pci bus id: 0000:11:00.0, compute capability: 6.1)
train file list:

../data/shuffle-part-0
../data/shuffle-part-1
../data/shuffle-part-10
../data/shuffle-part-11
../data/shuffle-part-12
../data/shuffle-part-13
../data/shuffle-part-14
../data/shuffle-part-15
../data/shuffle-part-16
../data/shuffle-part-17
../data/shuffle-part-18
../data/shuffle-part-19
../data/shuffle-part-2
../data/shuffle-part-20
../data/shuffle-part-21
../data/shuffle-part-22
../data/shuffle-part-23
../data/shuffle-part-24
../data/shuffle-part-25
../data/shuffle-part-26
../data/shuffle-part-27
../data/shuffle-part-28
../data/shuffle-part-29
../data/shuffle-part-3
../data/shuffle-part-30
../data/shuffle-part-31
../data/shuffle-part-32
../data/shuffle-part-33
../data/shuffle-part-34
../data/shuffle-part-35
../data/shuffle-part-36
../data/shuffle-part-37
../data/shuffle-part-38
../data/shuffle-part-39
../data/shuffle-part-4
../data/shuffle-part-40
../data/shuffle-part-41
../data/shuffle-part-42
../data/shuffle-part-43
../data/shuffle-part-44
../data/shuffle-part-45
../data/shuffle-part-46
../data/shuffle-part-47
../data/shuffle-part-48
../data/shuffle-part-49
../data/shuffle-part-5
../data/shuffle-part-50
../data/shuffle-part-51
../data/shuffle-part-52
../data/shuffle-part-53
../data/shuffle-part-54
../data/shuffle-part-55
../data/shuffle-part-56
../data/shuffle-part-57
../data/shuffle-part-58
../data/shuffle-part-59
../data/shuffle-part-6
../data/shuffle-part-60
../data/shuffle-part-61
../data/shuffle-part-62
../data/shuffle-part-63
../data/shuffle-part-64
../data/shuffle-part-65
../data/shuffle-part-66
../data/shuffle-part-67
../data/shuffle-part-68
../data/shuffle-part-69
../data/shuffle-part-7
../data/shuffle-part-70
../data/shuffle-part-71
../data/shuffle-part-72
../data/shuffle-part-73
../data/shuffle-part-74
../data/shuffle-part-75
../data/shuffle-part-76
../data/shuffle-part-77
../data/shuffle-part-78
../data/shuffle-part-79
../data/shuffle-part-8
../data/shuffle-part-80
../data/shuffle-part-81
../data/shuffle-part-82
../data/shuffle-part-83
../data/shuffle-part-84
../data/shuffle-part-85
../data/shuffle-part-86
../data/shuffle-part-87
../data/shuffle-part-88
../data/shuffle-part-89
../data/shuffle-part-9
../data/shuffle-part-90
../data/shuffle-part-91
../data/shuffle-part-92
../data/shuffle-part-93
../data/shuffle-part-94
../data/shuffle-part-95
../data/shuffle-part-96
../data/shuffle-part-97
../data/shuffle-part-98
../data/shuffle-part-99
build model...
build model on gpu tower...
tower:0...
tower:1...
tower:2...
tower:3...
build model on gpu tower done.
---------- Model Variabels -----------
1. embedding:0	/device:CPU:0	(450001, 100)	<dtype: 'float32'>
2. cpu_variables/rnn/lstm_cell/kernel:0	/device:GPU:0	(228, 1024)	<dtype: 'float32'>
3. cpu_variables/rnn/lstm_cell/bias:0	/device:GPU:0	(1024,)	<dtype: 'float32'>
4. cpu_variables/rnn/lstm_cell/w_f_diag:0	/device:GPU:0	(256,)	<dtype: 'float32'>
5. cpu_variables/rnn/lstm_cell/w_i_diag:0	/device:GPU:0	(256,)	<dtype: 'float32'>
6. cpu_variables/rnn/lstm_cell/w_o_diag:0	/device:GPU:0	(256,)	<dtype: 'float32'>
7. cpu_variables/rnn/lstm_cell/projection/kernel:0	/device:GPU:0	(256, 128)	<dtype: 'float32'>
8. cpu_variables/softmax_fw_w:0	/device:GPU:0	(128, 1)	<dtype: 'float32'>
9. cpu_variables/softmax_fw_b:0	/device:GPU:0	(1,)	<dtype: 'float32'>
------------------------
reduce model on cpu...
file=../data/shuffle-part-0, epoch=1 begins:
2018-10-30 20:17:25 : avg cost after    10 batches: cur_loss=0.073892, avg_loss=0.073892, 45.38 seconds elapsed ...
2018-10-30 20:18:07 : avg cost after    20 batches: cur_loss=0.073180, avg_loss=0.073536, 87.08 seconds elapsed ...
2018-10-30 20:18:48 : avg cost after    30 batches: cur_loss=0.071834, avg_loss=0.072969, 128.63 seconds elapsed ...
2018-10-30 20:19:30 : avg cost after    40 batches: cur_loss=0.068319, avg_loss=0.071806, 170.24 seconds elapsed ...
2018-10-30 20:20:13 : avg cost after    50 batches: cur_loss=0.060314, avg_loss=0.069508, 213.60 seconds elapsed ...
2018-10-30 20:20:55 : avg cost after    60 batches: cur_loss=0.057020, avg_loss=0.067427, 255.70 seconds elapsed ...
Cost time: 280.206422091 sec.
discardLines counter : 135080
file=../data/shuffle-part-1, epoch=2 begins:
2018-10-30 20:22:01 : avg cost after    76 batches: cur_loss=0.054337, avg_loss=0.054337, 41.46 seconds elapsed ...
2018-10-30 20:22:43 : avg cost after    86 batches: cur_loss=0.053693, avg_loss=0.054015, 83.08 seconds elapsed ...
2018-10-30 20:23:25 : avg cost after    96 batches: cur_loss=0.053092, avg_loss=0.053707, 125.18 seconds elapsed ...
2018-10-30 20:24:07 : avg cost after   106 batches: cur_loss=0.052687, avg_loss=0.053452, 166.98 seconds elapsed ...
2018-10-30 20:24:49 : avg cost after   116 batches: cur_loss=0.052356, avg_loss=0.053233, 208.54 seconds elapsed ...
2018-10-30 20:25:31 : avg cost after   126 batches: cur_loss=0.052048, avg_loss=0.053035, 250.58 seconds elapsed ...
Cost time: 275.106230974 sec.
discardLines counter : 135875
file=../data/shuffle-part-10, epoch=3 begins:
2018-10-30 20:26:37 : avg cost after   142 batches: cur_loss=0.051554, avg_loss=0.051554, 42.21 seconds elapsed ...
2018-10-30 20:27:19 : avg cost after   152 batches: cur_loss=0.051242, avg_loss=0.051398, 84.02 seconds elapsed ...
2018-10-30 20:28:01 : avg cost after   162 batches: cur_loss=0.050821, avg_loss=0.051206, 125.55 seconds elapsed ...
2018-10-30 20:28:43 : avg cost after   172 batches: cur_loss=0.050287, avg_loss=0.050976, 167.59 seconds elapsed ...
2018-10-30 20:29:25 : avg cost after   182 batches: cur_loss=0.049474, avg_loss=0.050676, 209.87 seconds elapsed ...
2018-10-30 20:30:07 : avg cost after   192 batches: cur_loss=0.048047, avg_loss=0.050238, 252.36 seconds elapsed ...
Cost time: 277.114656925 sec.
discardLines counter : 136057
file=../data/shuffle-part-11, epoch=4 begins:
2018-10-30 20:31:14 : avg cost after   208 batches: cur_loss=0.045498, avg_loss=0.045498, 42.02 seconds elapsed ...
2018-10-30 20:31:56 : avg cost after   218 batches: cur_loss=0.044547, avg_loss=0.045022, 84.02 seconds elapsed ...
2018-10-30 20:32:38 : avg cost after   228 batches: cur_loss=0.043798, avg_loss=0.044614, 126.14 seconds elapsed ...
2018-10-30 20:33:21 : avg cost after   238 batches: cur_loss=0.043139, avg_loss=0.044245, 168.39 seconds elapsed ...
2018-10-30 20:34:03 : avg cost after   248 batches: cur_loss=0.042518, avg_loss=0.043900, 210.24 seconds elapsed ...
2018-10-30 20:34:45 : avg cost after   258 batches: cur_loss=0.041938, avg_loss=0.043573, 252.26 seconds elapsed ...
Cost time: 277.235347033 sec.
discardLines counter : 135813
file=../data/shuffle-part-12, epoch=5 begins:
2018-10-30 20:35:51 : avg cost after   274 batches: cur_loss=0.041068, avg_loss=0.041068, 41.72 seconds elapsed ...
2018-10-30 20:36:34 : avg cost after   284 batches: cur_loss=0.040555, avg_loss=0.040812, 83.96 seconds elapsed ...
2018-10-30 20:37:16 : avg cost after   294 batches: cur_loss=0.040152, avg_loss=0.040592, 126.06 seconds elapsed ...
2018-10-30 20:37:57 : avg cost after   304 batches: cur_loss=0.039709, avg_loss=0.040371, 167.65 seconds elapsed ...
2018-10-30 20:38:40 : avg cost after   314 batches: cur_loss=0.039404, avg_loss=0.040178, 209.99 seconds elapsed ...
2018-10-30 20:39:22 : avg cost after   324 batches: cur_loss=0.039083, avg_loss=0.039995, 252.31 seconds elapsed ...
Cost time: 276.908824921 sec.
discardLines counter : 135442
file=../data/shuffle-part-13, epoch=6 begins:
2018-10-30 20:40:28 : avg cost after   340 batches: cur_loss=0.038717, avg_loss=0.038717, 41.98 seconds elapsed ...
2018-10-30 20:41:10 : avg cost after   350 batches: cur_loss=0.038457, avg_loss=0.038587, 83.74 seconds elapsed ...
2018-10-30 20:41:52 : avg cost after   360 batches: cur_loss=0.038300, avg_loss=0.038491, 125.37 seconds elapsed ...
2018-10-30 20:42:34 : avg cost after   370 batches: cur_loss=0.038069, avg_loss=0.038386, 167.69 seconds elapsed ...
2018-10-30 20:43:17 : avg cost after   380 batches: cur_loss=0.037855, avg_loss=0.038280, 210.01 seconds elapsed ...
2018-10-30 20:43:59 : avg cost after   390 batches: cur_loss=0.037661, avg_loss=0.038176, 252.02 seconds elapsed ...
Cost time: 277.392365932 sec.
discardLines counter : 136345
file=../data/shuffle-part-14, epoch=7 begins:
2018-10-30 20:45:06 : avg cost after   406 batches: cur_loss=0.037207, avg_loss=0.037207, 41.99 seconds elapsed ...
2018-10-30 20:45:48 : avg cost after   416 batches: cur_loss=0.036926, avg_loss=0.037066, 84.12 seconds elapsed ...
2018-10-30 20:46:31 : avg cost after   426 batches: cur_loss=0.036675, avg_loss=0.036936, 126.70 seconds elapsed ...
2018-10-30 20:47:13 : avg cost after   436 batches: cur_loss=0.036538, avg_loss=0.036837, 169.00 seconds elapsed ...
2018-10-30 20:47:55 : avg cost after   446 batches: cur_loss=0.036264, avg_loss=0.036722, 210.81 seconds elapsed ...
2018-10-30 20:48:37 : avg cost after   456 batches: cur_loss=0.036150, avg_loss=0.036627, 253.08 seconds elapsed ...
Cost time: 277.468503952 sec.
discardLines counter : 136306
file=../data/shuffle-part-15, epoch=8 begins:
2018-10-30 20:49:44 : avg cost after   472 batches: cur_loss=0.035903, avg_loss=0.035903, 42.21 seconds elapsed ...
2018-10-30 20:50:26 : avg cost after   482 batches: cur_loss=0.035772, avg_loss=0.035838, 84.37 seconds elapsed ...
2018-10-30 20:51:08 : avg cost after   492 batches: cur_loss=0.035627, avg_loss=0.035767, 126.42 seconds elapsed ...
2018-10-30 20:51:50 : avg cost after   502 batches: cur_loss=0.035517, avg_loss=0.035705, 168.15 seconds elapsed ...
2018-10-30 20:52:32 : avg cost after   512 batches: cur_loss=0.035380, avg_loss=0.035640, 210.21 seconds elapsed ...
2018-10-30 20:53:14 : avg cost after   522 batches: cur_loss=0.035230, avg_loss=0.035572, 252.38 seconds elapsed ...
Cost time: 276.935560942 sec.
discardLines counter : 135920
file=../data/shuffle-part-16, epoch=9 begins:
2018-10-30 20:54:20 : avg cost after   538 batches: cur_loss=0.035026, avg_loss=0.035026, 42.05 seconds elapsed ...
2018-10-30 20:55:02 : avg cost after   548 batches: cur_loss=0.034836, avg_loss=0.034931, 83.85 seconds elapsed ...
2018-10-30 20:55:44 : avg cost after   558 batches: cur_loss=0.034725, avg_loss=0.034862, 125.88 seconds elapsed ...
2018-10-30 20:56:26 : avg cost after   568 batches: cur_loss=0.034512, avg_loss=0.034775, 167.77 seconds elapsed ...
2018-10-30 20:57:08 : avg cost after   578 batches: cur_loss=0.034305, avg_loss=0.034681, 209.95 seconds elapsed ...
2018-10-30 20:57:50 : avg cost after   588 batches: cur_loss=0.034181, avg_loss=0.034598, 251.82 seconds elapsed ...
Cost time: 276.891119003 sec.
discardLines counter : 135270
file=../data/shuffle-part-17, epoch=10 begins:
2018-10-30 20:58:57 : avg cost after   604 batches: cur_loss=0.033943, avg_loss=0.033943, 42.07 seconds elapsed ...
2018-10-30 20:59:39 : avg cost after   614 batches: cur_loss=0.033813, avg_loss=0.033878, 84.17 seconds elapsed ...
2018-10-30 21:00:21 : avg cost after   624 batches: cur_loss=0.033634, avg_loss=0.033797, 126.19 seconds elapsed ...
2018-10-30 21:01:04 : avg cost after   634 batches: cur_loss=0.033530, avg_loss=0.033730, 168.22 seconds elapsed ...
2018-10-30 21:01:46 : avg cost after   644 batches: cur_loss=0.033422, avg_loss=0.033669, 210.70 seconds elapsed ...
2018-10-30 21:02:28 : avg cost after   654 batches: cur_loss=0.033348, avg_loss=0.033615, 252.80 seconds elapsed ...
Cost time: 277.533039093 sec.
discardLines counter : 136505
epoch:0   used time:280.206422091
epoch:1   used time:275.106230974
epoch:2   used time:277.114656925
epoch:3   used time:277.235347033
epoch:4   used time:276.908824921
epoch:5   used time:277.392365932
epoch:6   used time:277.468503952
epoch:7   used time:276.935560942
epoch:8   used time:276.891119003
epoch:9   used time:277.533039093
run 10 epoch use time:2772.79207087
