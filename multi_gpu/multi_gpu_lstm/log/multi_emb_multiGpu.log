
loading word table...
loading word table finished!!! 0.43 seconds escaped...
2018-11-21 21:03:22.632216: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-11-21 21:03:23.181196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 0 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:08:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-11-21 21:03:23.509221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 1 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:0b:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-11-21 21:03:23.843595: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 2 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:0e:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-11-21 21:03:24.186300: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1356] Found device 3 with properties: 
name: Tesla P40 major: 6 minor: 1 memoryClockRate(GHz): 1.531
pciBusID: 0000:11:00.0
totalMemory: 22.38GiB freeMemory: 22.21GiB
2018-11-21 21:03:24.195142: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1435] Adding visible gpu devices: 0, 1, 2, 3
2018-11-21 21:03:25.391351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:923] Device interconnect StreamExecutor with strength 1 edge matrix:
2018-11-21 21:03:25.391426: I tensorflow/core/common_runtime/gpu/gpu_device.cc:929]      0 1 2 3 
2018-11-21 21:03:25.391440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 0:   N Y Y Y 
2018-11-21 21:03:25.391446: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 1:   Y N Y Y 
2018-11-21 21:03:25.391452: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 2:   Y Y N Y 
2018-11-21 21:03:25.391460: I tensorflow/core/common_runtime/gpu/gpu_device.cc:942] 3:   Y Y Y N 
2018-11-21 21:03:25.393418: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21551 MB memory) -> physical GPU (device: 0, name: Tesla P40, pci bus id: 0000:08:00.0, compute capability: 6.1)
2018-11-21 21:03:25.794515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 21551 MB memory) -> physical GPU (device: 1, name: Tesla P40, pci bus id: 0000:0b:00.0, compute capability: 6.1)
2018-11-21 21:03:26.192124: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 21551 MB memory) -> physical GPU (device: 2, name: Tesla P40, pci bus id: 0000:0e:00.0, compute capability: 6.1)
2018-11-21 21:03:26.589422: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1053] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 21551 MB memory) -> physical GPU (device: 3, name: Tesla P40, pci bus id: 0000:11:00.0, compute capability: 6.1)
train file list:

../data/shuffle-part-0
../data/shuffle-part-1
../data/shuffle-part-10
../data/shuffle-part-11
../data/shuffle-part-12
../data/shuffle-part-13
../data/shuffle-part-14
../data/shuffle-part-15
../data/shuffle-part-16
../data/shuffle-part-17
../data/shuffle-part-18
../data/shuffle-part-19
../data/shuffle-part-2
../data/shuffle-part-20
../data/shuffle-part-21
../data/shuffle-part-22
../data/shuffle-part-23
../data/shuffle-part-24
../data/shuffle-part-25
../data/shuffle-part-26
../data/shuffle-part-27
../data/shuffle-part-28
../data/shuffle-part-29
../data/shuffle-part-3
../data/shuffle-part-30
../data/shuffle-part-31
../data/shuffle-part-32
../data/shuffle-part-33
../data/shuffle-part-34
../data/shuffle-part-35
../data/shuffle-part-36
../data/shuffle-part-37
../data/shuffle-part-38
../data/shuffle-part-39
../data/shuffle-part-4
../data/shuffle-part-40
../data/shuffle-part-41
../data/shuffle-part-42
../data/shuffle-part-43
../data/shuffle-part-44
../data/shuffle-part-45
../data/shuffle-part-46
../data/shuffle-part-47
../data/shuffle-part-48
../data/shuffle-part-49
../data/shuffle-part-5
../data/shuffle-part-50
../data/shuffle-part-51
../data/shuffle-part-52
../data/shuffle-part-53
../data/shuffle-part-54
../data/shuffle-part-55
../data/shuffle-part-56
../data/shuffle-part-57
../data/shuffle-part-58
../data/shuffle-part-59
../data/shuffle-part-6
../data/shuffle-part-60
../data/shuffle-part-61
../data/shuffle-part-62
../data/shuffle-part-63
../data/shuffle-part-64
../data/shuffle-part-65
../data/shuffle-part-66
../data/shuffle-part-67
../data/shuffle-part-68
../data/shuffle-part-69
../data/shuffle-part-7
../data/shuffle-part-70
../data/shuffle-part-71
../data/shuffle-part-72
../data/shuffle-part-73
../data/shuffle-part-74
../data/shuffle-part-75
../data/shuffle-part-76
../data/shuffle-part-77
../data/shuffle-part-78
../data/shuffle-part-79
../data/shuffle-part-8
../data/shuffle-part-80
../data/shuffle-part-81
../data/shuffle-part-82
../data/shuffle-part-83
../data/shuffle-part-84
../data/shuffle-part-85
../data/shuffle-part-86
../data/shuffle-part-87
../data/shuffle-part-88
../data/shuffle-part-89
../data/shuffle-part-9
../data/shuffle-part-90
../data/shuffle-part-91
../data/shuffle-part-92
../data/shuffle-part-93
../data/shuffle-part-94
../data/shuffle-part-95
../data/shuffle-part-96
../data/shuffle-part-97
../data/shuffle-part-98
../data/shuffle-part-99
build model...
build model on gpu tower...
tower:0...
tower:1...
tower:2...
tower:3...
build model on gpu tower done.
reduce model on cpu...
---------- Model Variabels -----------
1. embedding:0	/device:GPU:0	(450001, 100)	<dtype: 'float32'>
2. rnn/lstm_cell/kernel:0	/device:GPU:0	(228, 1024)	<dtype: 'float32'>
3. rnn/lstm_cell/bias:0	/device:GPU:0	(1024,)	<dtype: 'float32'>
4. rnn/lstm_cell/w_f_diag:0	/device:GPU:0	(256,)	<dtype: 'float32'>
5. rnn/lstm_cell/w_i_diag:0	/device:GPU:0	(256,)	<dtype: 'float32'>
6. rnn/lstm_cell/w_o_diag:0	/device:GPU:0	(256,)	<dtype: 'float32'>
7. rnn/lstm_cell/projection/kernel:0	/device:GPU:0	(256, 128)	<dtype: 'float32'>
8. softmax_fw_w:0	/device:GPU:0	(128, 1)	<dtype: 'float32'>
9. softmax_fw_b:0	/device:GPU:0	(1,)	<dtype: 'float32'>
10. beta1_power:0	/device:GPU:0	()	<dtype: 'float32'>
11. beta2_power:0	/device:GPU:0	()	<dtype: 'float32'>
12. rnn/lstm_cell/kernel/Adam:0	/device:GPU:0	(228, 1024)	<dtype: 'float32'>
13. rnn/lstm_cell/kernel/Adam_1:0	/device:GPU:0	(228, 1024)	<dtype: 'float32'>
14. rnn/lstm_cell/bias/Adam:0	/device:GPU:0	(1024,)	<dtype: 'float32'>
15. rnn/lstm_cell/bias/Adam_1:0	/device:GPU:0	(1024,)	<dtype: 'float32'>
16. rnn/lstm_cell/w_f_diag/Adam:0	/device:GPU:0	(256,)	<dtype: 'float32'>
17. rnn/lstm_cell/w_f_diag/Adam_1:0	/device:GPU:0	(256,)	<dtype: 'float32'>
18. rnn/lstm_cell/w_i_diag/Adam:0	/device:GPU:0	(256,)	<dtype: 'float32'>
19. rnn/lstm_cell/w_i_diag/Adam_1:0	/device:GPU:0	(256,)	<dtype: 'float32'>
20. rnn/lstm_cell/w_o_diag/Adam:0	/device:GPU:0	(256,)	<dtype: 'float32'>
21. rnn/lstm_cell/w_o_diag/Adam_1:0	/device:GPU:0	(256,)	<dtype: 'float32'>
22. rnn/lstm_cell/projection/kernel/Adam:0	/device:GPU:0	(256, 128)	<dtype: 'float32'>
23. rnn/lstm_cell/projection/kernel/Adam_1:0	/device:GPU:0	(256, 128)	<dtype: 'float32'>
24. softmax_fw_w/Adam:0	/device:GPU:0	(128, 1)	<dtype: 'float32'>
25. softmax_fw_w/Adam_1:0	/device:GPU:0	(128, 1)	<dtype: 'float32'>
26. softmax_fw_b/Adam:0	/device:GPU:0	(1,)	<dtype: 'float32'>
27. softmax_fw_b/Adam_1:0	/device:GPU:0	(1,)	<dtype: 'float32'>
------------------------
file=../data/shuffle-part-0, epoch=1 begins:
2018-11-21 21:04:46 : avg cost after    10 batches: cur_loss=0.067664, avg_loss=0.067664, 72.88 seconds elapsed ...
2018-11-21 21:05:54 : avg cost after    20 batches: cur_loss=0.063800, avg_loss=0.065732, 141.30 seconds elapsed ...
2018-11-21 21:07:03 : avg cost after    30 batches: cur_loss=0.061480, avg_loss=0.064315, 209.78 seconds elapsed ...
Cost time: 230.166577101 sec.
discardLines counter : 135080
file=../data/shuffle-part-1, epoch=2 begins:
2018-11-21 21:08:32 : avg cost after    43 batches: cur_loss=0.059424, avg_loss=0.059424, 68.49 seconds elapsed ...
2018-11-21 21:09:40 : avg cost after    53 batches: cur_loss=0.055474, avg_loss=0.057449, 136.81 seconds elapsed ...
2018-11-21 21:10:48 : avg cost after    63 batches: cur_loss=0.049410, avg_loss=0.054769, 205.22 seconds elapsed ...
Cost time: 225.282760859 sec.
discardLines counter : 135875
file=../data/shuffle-part-10, epoch=3 begins:
2018-11-21 21:12:17 : avg cost after    76 batches: cur_loss=0.047593, avg_loss=0.047593, 68.48 seconds elapsed ...
2018-11-21 21:13:25 : avg cost after    86 batches: cur_loss=0.047308, avg_loss=0.047451, 136.92 seconds elapsed ...
2018-11-21 21:14:34 : avg cost after    96 batches: cur_loss=0.047033, avg_loss=0.047311, 205.35 seconds elapsed ...
Cost time: 225.3916471 sec.
discardLines counter : 136057
file=../data/shuffle-part-11, epoch=4 begins:
2018-11-21 21:16:02 : avg cost after   109 batches: cur_loss=0.046805, avg_loss=0.046805, 68.46 seconds elapsed ...
2018-11-21 21:17:11 : avg cost after   119 batches: cur_loss=0.046731, avg_loss=0.046768, 137.16 seconds elapsed ...
2018-11-21 21:18:21 : avg cost after   129 batches: cur_loss=0.046528, avg_loss=0.046688, 206.83 seconds elapsed ...
Cost time: 227.248073816 sec.
discardLines counter : 135813
file=../data/shuffle-part-12, epoch=5 begins:
2018-11-21 21:19:51 : avg cost after   142 batches: cur_loss=0.046335, avg_loss=0.046335, 70.34 seconds elapsed ...
2018-11-21 21:21:02 : avg cost after   152 batches: cur_loss=0.046169, avg_loss=0.046252, 140.82 seconds elapsed ...
2018-11-21 21:22:12 : avg cost after   162 batches: cur_loss=0.045966, avg_loss=0.046157, 210.59 seconds elapsed ...
Cost time: 230.712510824 sec.
discardLines counter : 135442
file=../data/shuffle-part-13, epoch=6 begins:
2018-11-21 21:23:40 : avg cost after   175 batches: cur_loss=0.045721, avg_loss=0.045721, 68.46 seconds elapsed ...
2018-11-21 21:24:49 : avg cost after   185 batches: cur_loss=0.045586, avg_loss=0.045654, 136.73 seconds elapsed ...
2018-11-21 21:25:58 : avg cost after   195 batches: cur_loss=0.045475, avg_loss=0.045594, 206.58 seconds elapsed ...
Cost time: 227.449161053 sec.
discardLines counter : 136345
file=../data/shuffle-part-14, epoch=7 begins:
2018-11-21 21:27:29 : avg cost after   208 batches: cur_loss=0.045360, avg_loss=0.045360, 69.67 seconds elapsed ...
2018-11-21 21:28:39 : avg cost after   218 batches: cur_loss=0.045222, avg_loss=0.045291, 139.36 seconds elapsed ...
2018-11-21 21:29:49 : avg cost after   228 batches: cur_loss=0.045074, avg_loss=0.045219, 209.26 seconds elapsed ...
Cost time: 229.76749301 sec.
discardLines counter : 136306
file=../data/shuffle-part-15, epoch=8 begins:
2018-11-21 21:31:19 : avg cost after   241 batches: cur_loss=0.044942, avg_loss=0.044942, 69.75 seconds elapsed ...
2018-11-21 21:32:28 : avg cost after   251 batches: cur_loss=0.044852, avg_loss=0.044897, 139.31 seconds elapsed ...
2018-11-21 21:33:37 : avg cost after   261 batches: cur_loss=0.044753, avg_loss=0.044849, 207.93 seconds elapsed ...
